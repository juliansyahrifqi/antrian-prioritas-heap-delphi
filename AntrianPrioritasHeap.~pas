unit AntrianPrioritasHeap;

interface

uses
  Windows, Messages, SysUtils, Variants, Classes, Graphics, Controls, Forms,
  Dialogs, StdCtrls, ExtCtrls, MmSystem;

const
  maksAntrian=100;

type
  TForm1 = class(TForm)
    Panel1: TPanel;
    Panel2: TPanel;
    meja1: TLabel;
    meja2: TLabel;
    Label2: TLabel;
    Label3: TLabel;
    Button1: TButton;
    Button2: TButton;
    Button3: TButton;
    Button4: TButton;
    Panel3: TPanel;
    selanjutnya: TLabel;
    Label4: TLabel;
    procedure FormCreate(Sender: TObject);
    procedure Button3Click(Sender: TObject);
    procedure Button1Click(Sender: TObject);
    procedure Button4Click(Sender: TObject);
    procedure Button2Click(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  Form1: TForm1;
  antrian: array[1..maksAntrian] of string;
  bantrian:integer;

implementation

{$R *.dfm}

procedure TForm1.FormCreate(Sender:TObject);
begin
  bantrian:=0;
end;

function parent(i:integer):integer;
begin
  parent:=i div 2;
end;

function anakKiri(i:integer):integer;
begin
  anakKiri:=2*i;
end;

function anakKanan(i:integer):integer;
begin
  anakKanan:=(2*i)+1;
end;

function Leaf(i:integer):boolean;
begin
  if (i >= (bantrian/2)) and (i <= bantrian) then //Cek apakah leaf atau bukan
    Leaf:=true
  else
    Leaf:=false;
end;

procedure tukar(i:integer; j:integer);
var
  temp:string;
begin
  temp:=antrian[i];
  antrian[i]:=antrian[j];
  antrian[j]:=temp;
end;

procedure heap(i:integer);
begin
  if (Leaf(i)=false) then
  begin
    if (antrian[i] > antrian[anakKiri(i)]) or (antrian[i] > antrian[anakKanan(i)]) then
    begin
      if (antrian[anakKiri(i)] < antrian[anakKanan(i)]) then
      begin
        tukar(i,anakKiri(i));
        heap(anakKiri(i));
      end
      else
      begin
        tukar(i,anakKanan(i));
        heap(anakKanan(i));
      end;
    end;
  end;
end;

procedure shiftUp;
var
  i:integer;
  temp:string;

begin
  i:=bantrian;
  while(i > 1) and (antrian[i div 2] > antrian[i]) do
  begin
    temp := antrian[i];
    antrian[i]:= antrian[i div 2];
    antrian[i div 2]:=temp;
    i:=i div 2;
  end;
end;

procedure tambahAntrian(data:string);
begin
    antrian[bantrian+1]:=data;
    bantrian:=bantrian+1;
    shiftUp;
end;

procedure reorganisasi;
var
  i:integer;
begin
  i:=bantrian div 2;
  while(i >= 1)do
  begin
      heap(i);
      i:=i-1;
  end;
end;

function ambil:string;
var
  data:string;
begin
   data:=antrian[1];
   antrian[1]:=antrian[bantrian];
   bantrian:=bantrian-1;
   reorganisasi;
   ambil:=data;
end;

function terbilang(x:longint):string;
function bilang(x:longint):string;
begin
     case x of
     0:bilang:='';
     1:bilang:='satu';
     2:bilang:='dua';
     3:bilang:='tiga';
     4:bilang:='empat';
     5:bilang:='lima';
     6:bilang:='enam';
     7:bilang:='tujuh';
     8:bilang:='delapan';
     9:bilang:='sembilan';
     10:bilang:='sepuluh';
     11:bilang:='sebelas';
     end;
end;

begin
     if x<12 then
     terbilang := ' ' + bilang(x)

     else if x<20 then
     terbilang:=terbilang(x-10)+'belas'

     else if x<100 then
     terbilang:=terbilang(x div 10)+'puluh'+terbilang(x mod 10)
     else if x<200 then
     terbilang:='seratus'+terbilang(x-100)
     else if x<1000 then
     terbilang:=terbilang(x div 100)+'ratus'+terbilang(x mod 100)
     else if x<2000 then
     terbilang:='seribu'+terbilang(x-1000)
     else if x<1000000 then
     terbilang:=terbilang(x div 1000)+'ribu'+terbilang(x mod 1000)
     else if x<1000000000 then
     terbilang:=terbilang(x div 1000000)+'juta'+terbilang(x mod 1000000)
     else
     terbilang:=terbilang(x div 1000000000)+'milyar'+terbilang(x mod 1000000000);
end;


procedure TForm1.Button3Click(Sender: TObject);
var
  noAntri:string;
begin
  if(bantrian = 0) then
  begin
    antrian[1]:='P001';
    bantrian:=1;
    ShowMessage('Nomor antrian anda : P001');
  end
  else
  begin
    noAntri:='P'+Format('%.3d', [bantrian+1]);
    tambahAntrian(noAntri);
    ShowMessage('Nomor antrian anda : '+noAntri);
  end;
end;

procedure TForm1.Button1Click(Sender: TObject);
var
  nomor:string;
  i:integer;
  namafile:string;
begin
  if(bantrian = 0) then
  begin
    ShowMessage('Tidak ada antrian!');
    meja1.Caption:='';
    meja2.Caption:='';
  end
  else
  begin
    nomor:=ambil;
    meja1.Caption:=nomor;

    playsound('C:\audionumbers\nomor-urut.wav',0,0);
    for i:=1 to length(nomor) do
    begin
      namafile:='C:\audionumbers\'+copy(nomor,i,1)+'.wav';
      playsound(pchar(namafile),0,0);
    end;
    playsound('C:\audionumbers\loket.wav',0,0);
    playsound('C:\audionumbers\1.wav',0,0);
  end;
end;

procedure TForm1.Button4Click(Sender: TObject);
var
  noAntri:String;
begin
  if(bantrian = 0) then
  begin
    antrian[1]:='B001';
    bantrian:=1;
    ShowMessage('Nomor antrian anda : B001');
  end
  else
  begin
    noAntri:='B'+Format('%.3d', [bantrian+1]);
    tambahAntrian(noAntri);
    ShowMessage('Nomor antrian anda : '+noAntri);
  end;
end;


procedure TForm1.Button2Click(Sender: TObject);
var
  nomor:string;
  i:integer;
  namafile:string;
begin
  if(bantrian = 0) then
  begin
    ShowMessage('Tidak ada antrian!');
    meja1.Caption:='';
    meja2.Caption:='';
  end
  else
  begin
    nomor:=ambil;
    meja2.Caption:=nomor;

    playsound('C:\audionumbers\nomor-urut.wav',0,0);
    for i:=1 to length(nomor) do
    begin
      namafile:='C:\audionumbers\'+copy(nomor,i,1)+'.wav';
      playsound(pchar(namafile),0,0);
    end;
    playsound('C:\audionumbers\loket.wav',0,0);
    playsound('C:\audionumbers\2.wav',0,0);
  end;
end;
end.
